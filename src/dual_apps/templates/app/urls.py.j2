"""
URL configuration for {{ app_name }} app.

Dual-layer URL patterns:
- Frontend: /{{ app_name }}/... → views_frontend.py (HTMX templates)
- API: /api/v1/{{ app_name }}/... → views_api.py (DRF JSON)

Generated by dual-apps v{{ version }}

Namespace Usage:
    Frontend: {% raw %}{% url 'frontend:{{ app_name }}:{{ model_name_snake }}_list' %}{% endraw %}
    API:      {% raw %}{% url 'api:v1:{{ app_name }}:{{ model_name_snake }}-list' %}{% endraw %}
"""

from django.urls import path, include
from rest_framework.routers import DefaultRouter

{% if has_api %}
from {{ app_full_name | default(app_name) }} import views_api
{% endif %}
{% if has_frontend %}
from {{ app_full_name | default(app_name) }} import views_frontend
{% endif %}


app_name = '{{ app_name }}'


{% if has_api %}
# =============================================================================
# API Router (DRF ViewSets)
# =============================================================================
# Automatically generates:
#   GET    /{{ model_name_kebab }}s/          list
#   POST   /{{ model_name_kebab }}s/          create
#   GET    /{{ model_name_kebab }}s/{id}/     retrieve
#   PUT    /{{ model_name_kebab }}s/{id}/     update
#   PATCH  /{{ model_name_kebab }}s/{id}/     partial_update
#   DELETE /{{ model_name_kebab }}s/{id}/     destroy

router = DefaultRouter()
router.register(
    r'{{ model_name_kebab }}s',
    views_api.{{ app_name_pascal }}ViewSet,
    basename='{{ model_name_snake }}'
)

api_patterns = [
    path('', include(router.urls)),
]
{% endif %}


{% if has_frontend %}
# =============================================================================
# Frontend Patterns (Template Views)
# =============================================================================
# HTMX-powered template views with inline editing

frontend_patterns = [
    # List view
    path(
        '',
        views_frontend.{{ model_name_snake }}_list,
        name='{{ model_name_snake }}_list'
    ),

    # Create
    path(
        'create/',
        views_frontend.{{ model_name_snake }}_create,
        name='{{ model_name_snake }}_create'
    ),

    # Detail view
    path(
        '<uuid:pk>/',
        views_frontend.{{ model_name_snake }}_detail,
        name='{{ model_name_snake }}_detail'
    ),

    # Edit
    path(
        '<uuid:pk>/edit/',
        views_frontend.{{ model_name_snake }}_edit,
        name='{{ model_name_snake }}_edit'
    ),

    # Delete
    path(
        '<uuid:pk>/delete/',
        views_frontend.{{ model_name_snake }}_delete,
        name='{{ model_name_snake }}_delete'
    ),

    # Archive
    path(
        '<uuid:pk>/archive/',
        views_frontend.{{ model_name_snake }}_archive,
        name='{{ model_name_snake }}_archive'
    ),
]
{% endif %}


# =============================================================================
# Combined URL Patterns
# =============================================================================
# Include in project urls.py:
#   path('{{ app_name }}/', include('{{ app_name }}.urls')),
#   path('api/v1/{{ app_name }}/', include(('{{ app_name }}.urls', '{{ app_name }}'), namespace='api:v1:{{ app_name }}')),

urlpatterns = [
    {% if has_api %}
    path('api/', include((api_patterns, 'api'))),
    {% endif %}
    {% if has_frontend %}
    path('', include((frontend_patterns, 'frontend'))),
    {% endif %}
]

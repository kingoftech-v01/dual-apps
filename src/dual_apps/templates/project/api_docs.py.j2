"""
API Documentation configuration for {{ project_name }}.
Generated by dual-apps v{{ version }}

OpenAPI/Swagger documentation using drf-spectacular.
"""

from drf_spectacular.views import (
    SpectacularAPIView,
    SpectacularRedocView,
    SpectacularSwaggerView,
)
from django.urls import path

# API Documentation URLs
# Add these to your urlpatterns

api_docs_urlpatterns = [
    # OpenAPI Schema (JSON/YAML)
    path("api/schema/", SpectacularAPIView.as_view(), name="schema"),

    # Swagger UI
    path(
        "api/docs/",
        SpectacularSwaggerView.as_view(url_name="schema"),
        name="swagger-ui"
    ),

    # ReDoc
    path(
        "api/redoc/",
        SpectacularRedocView.as_view(url_name="schema"),
        name="redoc"
    ),
]


# DRF Spectacular Settings (add to settings/base.py)
SPECTACULAR_SETTINGS = {
    "TITLE": "{{ project_name_display }} API",
    "DESCRIPTION": """
## {{ project_name_display }} API

RESTful API with dual-layer architecture.

### Features
- Full CRUD operations
- JWT/Session authentication
- Owner-based permissions
- Pagination and filtering

### Authentication
{% if auth_type == 'jwt' %}
Use JWT tokens for API authentication:

1. Obtain tokens: `POST /api/auth/login/`
2. Use access token: `Authorization: Bearer <token>`
3. Refresh token: `POST /api/auth/token/refresh/`
{% else %}
Use session authentication:

1. Login: `POST /api/auth/login/`
2. Include session cookie in requests
{% endif %}

### Rate Limits
- Anonymous: 100 requests/minute
- Authenticated: 1000 requests/minute
    """,
    "VERSION": "1.0.0",
    "SERVE_INCLUDE_SCHEMA": False,

    # Authentication
    "SECURITY": [
{% if auth_type == 'jwt' %}
        {"BearerAuth": []},
{% endif %}
        {"SessionAuth": []},
    ],

    # Components
    "COMPONENT_SPLIT_REQUEST": True,
    "COMPONENT_NO_READ_ONLY_REQUIRED": True,

    # Schema
    "SCHEMA_PATH_PREFIX": r"/api/v1",
    "SCHEMA_PATH_PREFIX_TRIM": True,

    # Tags
    "TAGS": [
{% for app in apps_config %}
        {"name": "{{ app.name_title }}", "description": "{{ app.name_title }} management endpoints"},
{% endfor %}
        {"name": "Authentication", "description": "User authentication and registration"},
        {"name": "OAuth", "description": "Social authentication"},
    ],

    # Sorting
    "SORT_OPERATIONS": True,
    "SORT_OPERATION_PARAMETERS": True,

    # Extensions
    "EXTENSIONS_INFO": {
        "x-logo": {
            "url": "/static/logo.png",
            "altText": "{{ project_name_display }}"
        }
    },

    # Enum
    "ENUM_NAME_OVERRIDES": {},
    "ENUM_ADD_EXPLICIT_BLANK_NULL_CHOICE": False,

    # Postprocessing
    "POSTPROCESSING_HOOKS": [],
}

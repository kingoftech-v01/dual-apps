"""
E-commerce URL Configuration for {{ project_name }}.
Generated by dual-apps v{{ version }} - E-commerce Template

Includes both frontend (HTMX) and API (DRF) URLs.
"""

from django.urls import path, include
from rest_framework.routers import DefaultRouter

from . import views_api
from . import views_frontend

app_name = "shop"

# =============================================================================
# API Router
# =============================================================================

router = DefaultRouter()
router.register(r"categories", views_api.CategoryViewSet, basename="category")
router.register(r"products", views_api.ProductViewSet, basename="product")
router.register(r"cart", views_api.CartViewSet, basename="cart")
router.register(r"orders", views_api.OrderViewSet, basename="order")
router.register(r"wishlist", views_api.WishlistViewSet, basename="wishlist")

# Nested reviews under products
# /api/v1/shop/products/{slug}/reviews/

# =============================================================================
# Frontend URLs (HTMX)
# =============================================================================

frontend_urlpatterns = [
    # Home & Catalog
    path("", views_frontend.HomeView.as_view(), name="home"),
    path("products/", views_frontend.ProductListView.as_view(), name="product_list"),
    path("products/<slug:slug>/", views_frontend.ProductDetailView.as_view(), name="product_detail"),
    path("category/<slug:slug>/", views_frontend.CategoryView.as_view(), name="category"),

    # Search
    path("search/", views_frontend.SearchView.as_view(), name="search"),

    # Cart
    path("cart/", views_frontend.CartView.as_view(), name="cart"),
    path("cart/add/<uuid:product_id>/", views_frontend.AddToCartView.as_view(), name="add_to_cart"),
    path("cart/update/<uuid:item_id>/", views_frontend.UpdateCartItemView.as_view(), name="update_cart"),
    path("cart/remove/<uuid:item_id>/", views_frontend.RemoveFromCartView.as_view(), name="remove_from_cart"),
    path("cart/apply-coupon/", views_frontend.ApplyCouponView.as_view(), name="apply_coupon"),

    # Checkout
    path("checkout/", views_frontend.CheckoutView.as_view(), name="checkout"),
    path("checkout/confirmation/<str:order_number>/", views_frontend.OrderConfirmationView.as_view(), name="order_confirmation"),

    # Orders (authenticated)
    path("orders/", views_frontend.OrderListView.as_view(), name="order_list"),
    path("orders/<str:order_number>/", views_frontend.OrderDetailView.as_view(), name="order_detail"),

    # Wishlist (authenticated)
    path("wishlist/", views_frontend.WishlistView.as_view(), name="wishlist"),
    path("wishlist/add/<uuid:product_id>/", views_frontend.AddToWishlistView.as_view(), name="add_to_wishlist"),
    path("wishlist/remove/<uuid:product_id>/", views_frontend.RemoveFromWishlistView.as_view(), name="remove_from_wishlist"),

    # Reviews
    path("products/<slug:slug>/review/", views_frontend.CreateReviewView.as_view(), name="create_review"),

    # HTMX Partials
    path("partials/cart-count/", views_frontend.CartCountPartial.as_view(), name="cart_count_partial"),
    path("partials/product-card/<uuid:product_id>/", views_frontend.ProductCardPartial.as_view(), name="product_card_partial"),
]

# =============================================================================
# API URLs
# =============================================================================

api_urlpatterns = [
    path("", include(router.urls)),

    # Nested reviews
    path(
        "products/<slug:product_slug>/reviews/",
        views_api.ReviewViewSet.as_view({"get": "list", "post": "create"}),
        name="product_reviews"
    ),
]

# =============================================================================
# Main URL Patterns
# =============================================================================

urlpatterns = [
    # Frontend
    path("", include(frontend_urlpatterns)),

    # API (add to project's api/v1/ namespace)
    # path("api/v1/shop/", include(api_urlpatterns)),
]

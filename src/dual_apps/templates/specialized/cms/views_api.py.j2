"""
CMS API views for {{ app_name }} app.
Generated by dual-apps v{{ version }}
"""

from rest_framework import viewsets
from rest_framework.permissions import IsAuthenticatedOrReadOnly

from .models import Page, PageBlock, Menu, MenuItem, MediaFile, Form
from .serializers import (
    PageSerializer, PageBlockSerializer, MenuSerializer, MenuItemSerializer,
    MediaFileSerializer, FormSerializer
)
from .permissions import IsOwnerOrReadOnly


class PageViewSet(viewsets.ModelViewSet):
    """Page API."""
    queryset = Page.objects.filter(status='published')
    serializer_class = PageSerializer
    permission_classes = [IsAuthenticatedOrReadOnly, IsOwnerOrReadOnly]
    lookup_field = 'slug'


class PageBlockViewSet(viewsets.ModelViewSet):
    """Page block API."""
    queryset = PageBlock.objects.filter(is_active=True)
    serializer_class = PageBlockSerializer
    permission_classes = [IsAuthenticatedOrReadOnly]


class MenuViewSet(viewsets.ReadOnlyModelViewSet):
    """Menu API."""
    queryset = Menu.objects.all()
    serializer_class = MenuSerializer
    lookup_field = 'slug'


class MenuItemViewSet(viewsets.ModelViewSet):
    """Menu item API."""
    queryset = MenuItem.objects.filter(is_active=True)
    serializer_class = MenuItemSerializer
    permission_classes = [IsAuthenticatedOrReadOnly]


class MediaFileViewSet(viewsets.ModelViewSet):
    """Media file API."""
    queryset = MediaFile.objects.all()
    serializer_class = MediaFileSerializer
    permission_classes = [IsAuthenticatedOrReadOnly]


class FormViewSet(viewsets.ReadOnlyModelViewSet):
    """Form API (read-only)."""
    queryset = Form.objects.filter(is_active=True)
    serializer_class = FormSerializer
    lookup_field = 'slug'


# Compatibility alias
{{ app_name_pascal }}ViewSet = PageViewSet

{% raw %}{% extends "saas/base_saas.html" %}

{% block title %}Pricing - {{ project_name_display }}{% endblock %}

{% block saas_content %}
<div class="text-center mb-5">
    <h1 class="display-5 fw-bold">Simple, Transparent Pricing</h1>
    <p class="lead text-muted">Choose the plan that fits your needs</p>

    <div class="btn-group mb-4" role="group">
        <input type="radio" class="btn-check" name="billing" id="monthly" checked onchange="toggleBilling('monthly')">
        <label class="btn btn-outline-primary" for="monthly">Monthly</label>
        <input type="radio" class="btn-check" name="billing" id="yearly" onchange="toggleBilling('yearly')">
        <label class="btn btn-outline-primary" for="yearly">Yearly (Save 20%)</label>
    </div>
</div>

<div class="row justify-content-center">
    {% for plan in plans %}
    <div class="col-md-4 mb-4">
        <div class="card h-100 {% if plan.is_popular %}border-primary{% endif %}">
            {% if plan.is_popular %}
            <div class="card-header bg-primary text-white text-center">Most Popular</div>
            {% endif %}
            <div class="card-body text-center">
                <h4 class="card-title">{{ plan.name }}</h4>
                <p class="text-muted">{{ plan.description }}</p>

                <div class="my-4">
                    <span class="display-4 fw-bold">
                        $<span class="price-monthly">{{ plan.price_monthly }}</span>
                        <span class="price-yearly d-none">{{ plan.price_yearly }}</span>
                    </span>
                    <span class="text-muted">/month</span>
                </div>

                <ul class="list-unstyled text-start mb-4">
                    {% for feature in plan.features %}
                    <li class="mb-2">
                        <span class="text-success">âœ“</span> {{ feature }}
                    </li>
                    {% endfor %}
                </ul>

                {% if user.is_authenticated %}
                    {% if current_plan == plan.id %}
                    <button class="btn btn-secondary w-100" disabled>Current Plan</button>
                    {% elif plan.price_monthly == 0 %}
                    <a href="{% url 'saas:downgrade' plan.id %}" class="btn btn-outline-primary w-100">Downgrade</a>
                    {% else %}
                    <a href="{% url 'saas:subscribe' plan.id %}" class="btn btn-primary w-100">
                        {% if current_plan %}Upgrade{% else %}Get Started{% endif %}
                    </a>
                    {% endif %}
                {% else %}
                <a href="{% url 'account_signup' %}?plan={{ plan.id }}" class="btn btn-primary w-100">Get Started</a>
                {% endif %}
            </div>
        </div>
    </div>
    {% endfor %}
</div>

<!-- FAQ Section -->
<div class="mt-5">
    <h2 class="text-center mb-4">Frequently Asked Questions</h2>
    <div class="accordion" id="faqAccordion">
        <div class="accordion-item">
            <h3 class="accordion-header">
                <button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#faq1">
                    Can I change my plan later?
                </button>
            </h3>
            <div id="faq1" class="accordion-collapse collapse show" data-bs-parent="#faqAccordion">
                <div class="accordion-body">
                    Yes! You can upgrade or downgrade your plan at any time. Changes take effect immediately.
                </div>
            </div>
        </div>
        <div class="accordion-item">
            <h3 class="accordion-header">
                <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#faq2">
                    What payment methods do you accept?
                </button>
            </h3>
            <div id="faq2" class="accordion-collapse collapse" data-bs-parent="#faqAccordion">
                <div class="accordion-body">
                    We accept all major credit cards (Visa, Mastercard, American Express) and PayPal.
                </div>
            </div>
        </div>
        <div class="accordion-item">
            <h3 class="accordion-header">
                <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#faq3">
                    Is there a free trial?
                </button>
            </h3>
            <div id="faq3" class="accordion-collapse collapse" data-bs-parent="#faqAccordion">
                <div class="accordion-body">
                    Yes! All paid plans come with a 14-day free trial. No credit card required to start.
                </div>
            </div>
        </div>
    </div>
</div>

<script>
function toggleBilling(type) {
    document.querySelectorAll('.price-monthly').forEach(el => {
        el.classList.toggle('d-none', type === 'yearly');
    });
    document.querySelectorAll('.price-yearly').forEach(el => {
        el.classList.toggle('d-none', type === 'monthly');
    });
}
</script>
{% endblock %}
{% endraw %}

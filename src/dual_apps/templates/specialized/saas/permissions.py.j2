"""
SaaS permissions for {{ app_name }} app.
Generated by dual-apps v{{ version }}
"""

from rest_framework import permissions


class IsOwnerOrReadOnly(permissions.BasePermission):
    def has_object_permission(self, request, view, obj):
        if request.method in permissions.SAFE_METHODS:
            return True
        if hasattr(obj, 'owner'):
            return obj.owner == request.user
        return False


class IsOrganizationMember(permissions.BasePermission):
    def has_object_permission(self, request, view, obj):
        from .models import OrganizationMember
        return OrganizationMember.objects.filter(organization=obj, user=request.user).exists()

# API Reference - {{ app_name_title }}

## Base URL

```
/api/v1/{{ app_name }}/
```

## Authentication

All write operations require authentication.

{% if use_allauth %}
### Session Authentication (Allauth)
Use cookies/session after logging in at `/accounts/login/`.
{% elif use_jwt %}
### JWT Authentication

{% if use_httponly_jwt %}
JWT tokens are stored in httpOnly cookies. After login, the browser automatically includes
the token in all requests.

**Login:**
```http
POST /api/v1/auth/login/
Content-Type: application/json

{
  "email": "user@example.com",
  "password": "password"
}
```

**Response:** Sets httpOnly cookie with access token.

**Refresh Token:**
```http
POST /api/v1/auth/refresh/
```

**Logout:**
```http
POST /api/v1/auth/logout/
```
{% else %}
Include the JWT token in the Authorization header:
```http
Authorization: Bearer <access_token>
```

**Login:**
```http
POST /api/v1/auth/login/
Content-Type: application/json

{
  "email": "user@example.com",
  "password": "password"
}
```

**Response:**
```json
{
  "access": "eyJ...",
  "refresh": "eyJ..."
}
```

**Refresh Token:**
```http
POST /api/v1/auth/refresh/
Content-Type: application/json

{
  "refresh": "eyJ..."
}
```

**Response:**
```json
{
  "access": "eyJ..."
}
```
{% endif %}
{% else %}
### Session Authentication
Use session cookies after logging in at `/admin/login/`.
{% endif %}

## Endpoints

### List {{ model_name_plural }}

```http
GET /api/v1/{{ app_name }}/{{ model_name_kebab }}s/
```

**Query Parameters:**
| Parameter | Type | Description |
|-----------|------|-------------|
| `search` | string | Search in title, description |
| `status` | string | Filter by status (draft, active, archived) |
| `ordering` | string | Order by field (-created_at, title) |
| `page` | integer | Page number |
| `page_size` | integer | Items per page (max 100) |

**Response:** `200 OK`
```json
{
  "count": 100,
  "next": "/api/v1/{{ app_name }}/{{ model_name_kebab }}s/?page=2",
  "previous": null,
  "results": [
    {
      "id": "uuid",
      "url": "/api/v1/{{ app_name }}/{{ model_name_kebab }}s/uuid/",
      "title": "Example",
      "status": "active",
      "owner": {"id": 1, "username": "user"},
      "created_at": "2026-02-03T12:00:00Z"
    }
  ]
}
```

### Create {{ model_name }}

```http
POST /api/v1/{{ app_name }}/{{ model_name_kebab }}s/
```

**Request Body:**
```json
{
  "title": "New Item",
  "description": "Description",
  "status": "draft"
}
```

**Response:** `201 Created`

### Retrieve {{ model_name }}

```http
GET /api/v1/{{ app_name }}/{{ model_name_kebab }}s/{id}/
```

**Response:** `200 OK`

### Update {{ model_name }}

```http
PUT /api/v1/{{ app_name }}/{{ model_name_kebab }}s/{id}/
PATCH /api/v1/{{ app_name }}/{{ model_name_kebab }}s/{id}/
```

**Response:** `200 OK`

### Delete {{ model_name }}

```http
DELETE /api/v1/{{ app_name }}/{{ model_name_kebab }}s/{id}/
```

**Response:** `204 No Content`

### Archive {{ model_name }}

```http
POST /api/v1/{{ app_name }}/{{ model_name_kebab }}s/{id}/archive/
```

**Response:** `200 OK`
```json
{"status": "archived", "id": "uuid"}
```

### Publish {{ model_name }}

```http
POST /api/v1/{{ app_name }}/{{ model_name_kebab }}s/{id}/publish/
```

**Response:** `200 OK`
```json
{"status": "published", "id": "uuid"}
```

### My Items

```http
GET /api/v1/{{ app_name }}/{{ model_name_kebab }}s/my_items/
```

Returns only items owned by authenticated user.

## Error Responses

| Code | Description |
|------|-------------|
| 400 | Bad Request - Validation error |
| 401 | Unauthorized - Authentication required |
| 403 | Forbidden - Permission denied |
| 404 | Not Found - Resource doesn't exist |
| 429 | Too Many Requests - Rate limit exceeded |

## Rate Limiting

API requests are rate limited:
- Anonymous users: 100 requests/hour
- Authenticated users: 1000 requests/hour

Rate limit headers are included in responses:
```http
X-RateLimit-Limit: 1000
X-RateLimit-Remaining: 999
X-RateLimit-Reset: 1706961600
```

## API Documentation

Interactive API documentation is available at:
- **Swagger UI:** `/api/v1/docs/`
- **OpenAPI Schema:** `/api/v1/schema/`

{% if use_react %}
## React API Client

The React frontend includes a pre-configured API client:

```javascript
import { apiClient } from './api/client';

// List items
const { data } = await apiClient.get('/{{ app_name }}/{{ model_name_kebab }}s/');

// Create item
const { data } = await apiClient.post('/{{ app_name }}/{{ model_name_kebab }}s/', {
  title: 'New Item',
  status: 'draft'
});

// Update item
const { data } = await apiClient.patch('/{{ app_name }}/{{ model_name_kebab }}s/uuid/', {
  title: 'Updated'
});

// Delete item
await apiClient.delete('/{{ app_name }}/{{ model_name_kebab }}s/uuid/');
```

The client automatically handles:
{% if use_httponly_jwt %}
- Credentials (cookies) inclusion
{% else %}
- JWT token injection
- Token refresh on 401 errors
{% endif %}
- Error handling
{% endif %}

---
Generated by dual-apps v{{ version }}

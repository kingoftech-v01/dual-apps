# Architecture - {{ app_name_title }}

## Dual Layer Architecture

```
Frontend Layer (Human)    → HTML + HTMX + Alpine.js + Tailwind
API Layer (Machine)       → DRF ViewSets + OpenAPI/Swagger
Database Layer            → PostgreSQL + UUID PK + indexes
```

## Data Flow

```mermaid
graph TB
    subgraph "Frontend Layer"
        UI[User Interface /{{ app_name }}/]
        VF[views_frontend.py]
        HTMX[HTMX Requests]
    end

    subgraph "API Layer"
        VA[views_api.py]
        DRF[DRF ViewSets]
        S[Serializers]
    end

    subgraph "Data Layer"
        DB[PostgreSQL]
    end

    UI --> VF
    VF --> HTMX
    HTMX --> VA
    VA --> S
    S --> DB
    DB --> S
    S --> VA
    VA --> HTMX
    HTMX --> VF
    VF --> UI
```

## URL Namespaces

```
Frontend: frontend:{{ app_name }}:{{ model_name_snake }}_list
API:      api:v1:{{ app_name }}:{{ model_name_snake }}-list
```

## File Structure

```
{{ app_name }}/
├── {{ app_name }}/
│   ├── models.py           # {{ model_name }} with UUID PK
│   ├── views_frontend.py   # HTMX template views
│   ├── views_api.py        # DRF ViewSet
│   ├── serializers.py      # List/Detail/Create
│   ├── urls.py             # Dual patterns
│   ├── forms.py            # Django forms
│   ├── permissions.py      # IsOwnerOrReadOnly
│   └── admin.py            # Admin config
├── templates/{{ app_name }}/
│   ├── list.html           # HTMX list
│   ├── detail.html         # Detail view
│   └── form.html           # Create/Edit
├── static/{{ app_name }}/
│   ├── css/style.css
│   └── js/app.js
└── tests/
    ├── test_models.py
    ├── test_api.py
    └── test_frontend.py
```

## Permissions Flow

```mermaid
graph TD
    A[Anonymous] -->|Public only| Read
    B[Authenticated] -->|Own + Public| ReadOwn
    C[Owner] -->|Full CRUD| WriteOwn
    D[Staff] -->|All| AdminAll
```

---
Generated by dual-apps v{{ version }}

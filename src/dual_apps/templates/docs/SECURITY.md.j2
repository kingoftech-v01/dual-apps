# Security Policy - {{ app_name_title }}

## OWASP Django Security Checklist

### 1. HTTPS & Headers
```python
# settings.py
SECURE_SSL_REDIRECT = True
SECURE_HSTS_SECONDS = 31536000
SECURE_HSTS_INCLUDE_SUBDOMAINS = True
SECURE_HSTS_PRELOAD = True
SECURE_CONTENT_TYPE_NOSNIFF = True
SECURE_BROWSER_XSS_FILTER = True
X_FRAME_OPTIONS = 'DENY'
```

### 2. CSRF & Sessions
```python
CSRF_COOKIE_SECURE = True
SESSION_COOKIE_SECURE = True
SESSION_COOKIE_HTTPONLY = True
SESSION_COOKIE_SAMESITE = 'Lax'
```
{% if use_jwt %}

### 3. JWT Security
{% if use_httponly_jwt %}
JWT tokens are stored in httpOnly cookies:
- Tokens are not accessible via JavaScript (XSS protection)
- Automatic cookie handling by browser
- CSRF protection via SameSite attribute
{% else %}
JWT tokens are stored in localStorage:
- Short access token lifetime (15 minutes)
- Refresh token rotation enabled
- Token blacklisting on logout
{% endif %}

```python
SIMPLE_JWT = {
    'ACCESS_TOKEN_LIFETIME': timedelta(minutes=15),
    'REFRESH_TOKEN_LIFETIME': timedelta(days=7),
    'ROTATE_REFRESH_TOKENS': True,
    'BLACKLIST_AFTER_ROTATION': True,
{% if use_httponly_jwt %}
    'AUTH_COOKIE': 'access_token',
    'AUTH_COOKIE_SECURE': True,
    'AUTH_COOKIE_HTTP_ONLY': True,
    'AUTH_COOKIE_SAMESITE': 'Lax',
{% endif %}
}
```
{% endif %}

### 4. Database Security
- [x] UUID primary keys (no enumeration attacks)
- [x] Django ORM only (no raw SQL)
- [x] Input validation via serializers
- [x] django-filter for safe filtering

### 5. Permissions
- [x] IsOwnerOrReadOnly permission class
- [x] Staff escalation for admin actions
- [x] @login_required on all write views

### 6. Rate Limiting
```python
REST_FRAMEWORK = {
    'DEFAULT_THROTTLE_CLASSES': [
        'rest_framework.throttling.AnonRateThrottle',
        'rest_framework.throttling.UserRateThrottle'
    ],
    'DEFAULT_THROTTLE_RATES': {
        'anon': '100/hour',
        'user': '1000/hour'
    }
}
```

### 7. Security Module
```
apps/core/security/
├── validators.py       # Input validation
├── middleware.py       # Security headers
├── throttling.py       # Rate limiting
└── decorators.py       # Security decorators
```

### 8. Security Scanning
```bash
# Run security scans
pip install safety bandit
safety check --full-report
bandit -r {{ app_name }}
```
{% if use_react %}

### 9. React Frontend Security
{% if use_httponly_jwt %}
- JWT tokens in httpOnly cookies (XSS protected)
- No token access via JavaScript
{% else %}
- Token storage in localStorage
- Axios interceptors for token refresh
{% endif %}
- CORS configuration for API access
- Content Security Policy headers
{% endif %}
{% if use_htmx %}

### 9. HTMX Security
- CSRF token injection on all HTMX requests
- Safe HTML swapping (no eval)
- hx-headers for authentication
{% endif %}

## Reporting Vulnerabilities

Please report security issues to: security@example.com

**Do NOT create public GitHub issues for security vulnerabilities.**

## Security Checklist

- [ ] HTTPS enabled in production
- [ ] Security headers configured
- [ ] CSRF protection active
{% if use_jwt %}
- [ ] JWT token expiration tested
- [ ] Token refresh working
{% if use_httponly_jwt %}
- [ ] httpOnly cookies verified
{% endif %}
{% endif %}
- [ ] Permissions tested
- [ ] Rate limiting configured
- [ ] Dependencies scanned (safety check)
- [ ] Code scanned (bandit)
- [ ] E2E auth flow tested

---
Generated by dual-apps v{{ version }}
